{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Obsidian Notes","text":"<p>Publish your public notes with MkDocs</p>"},{"location":"#hello-world","title":"Hello World!","text":"<p>The <code>index.md</code> in the <code>/docs</code> folder is the homepage you see here.</p> <p>The folders in <code>/docs</code> appear as the main sections on the navigation bar.</p> <p>The notes appear as pages within these sections. For example, Note 1 in <code>Topic 1</code></p>"},{"location":"Features/LaTeX%20Math%20Support/","title":"LaTeX Math Support","text":"<p>LaTeX math is supported using MathJax.</p> <p>Inline math looks like \\(f(x) = x^2\\). The input for this is <code>$f(x) = x^2$</code>. Use <code>$...$</code>.</p> <p>For a block of math, use <code>$$...$$</code> on separate lines</p> <pre><code>$$\nF(x) = \\int^a_b \\frac{1}{2}x^4\n$$\n</code></pre> <p>gives </p> \\[ F(x) = \\int^a_b \\frac{1}{2}x^4 \\]"},{"location":"Features/Mermaid%20Diagrams/","title":"Mermaid diagrams","text":"<p>Here's the example from MkDocs Material documentation: </p> <pre><code>graph LR\n  A[Start] --&gt; B{Error?};\n  B --&gt;|Yes| C[Hmm...];\n  C --&gt; D[Debug];\n  D --&gt; B;\n  B ----&gt;|No| E[Yay!];</code></pre>"},{"location":"Features/Text%20Formatting/","title":"Text Formatting","text":"<p>You can have lists like this</p> <ul> <li>first</li> <li>second</li> <li>third</li> </ul> <p>Or checklist lists to</p> <ul> <li> Get</li> <li> things</li> <li> done</li> </ul> <p>Also, get highlights and strikethroughs as above (similar to Obsidian).</p> <p>More formatting options for your webpage here. (but not compatible with Obsidian)</p>"},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/","title":"PVE \u72ec\u663e\u76f4\u901awindows","text":"","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#grub","title":"Grub\u914d\u7f6e","text":"<p>\u53c2\u8003 PVE \u96c6\u6210\u663e\u5361\u76f4\u901a\u98de\u725bOS#\u66f4\u65b0Grub</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#windows","title":"\u5b89\u88c5windows\u5e76\u542f\u7528\u8fdc\u7a0b\u767b\u9646","text":"<p>\u9996\u5148\u6211\u4eec\u4f7f\u7528\u9ed8\u8ba4\u663e\u5361\u6765\u5b89\u88c5windows \uff08\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7PVE console\u6765\u67e5\u770b\u5f53\u524d\u753b\u9762\uff09 \u5b89\u88c5\u8fc7\u7a0b\u53ef\u4ee5\u53c2\u8003 1</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#vfiomodule","title":"\u5f00\u673a\u52a0\u8f7d<code>vfio</code>module","text":"<p>\u7f16\u8f91<code>/etc/modules</code>\uff0c\u52a0\u5165\u4ee5\u4e0b\u5167\u5bb9</p> <pre><code>vfio\nvfio_iommu_type1\nvfio_pci\n</code></pre> <p>\u4e5f\u8bb8\u5728\u5176\u4ed6\u6559\u7a0b\u4e2d\u8fd8\u4f1a\u591a\u52a0\u4e00\u4e2a<code>vfio_virqfd</code>\uff0c\u4e0d\u8fc7\u5728 kernel6.2 \u4e4b\u540e\u8fd9\u4e2a\u6a21\u5757\u4e0d\u518d\u9700\u8981\u6dfb\u52a0\u4e86\uff0c\u5df2\u7ecf\u5305\u542b\u5728<code>vfio</code>\u4e2d\u4e86</p> <p>\u7f16\u8f91\u5b8c\u6210\u540e\u4f7f\u7528<code>update-initramfs -u -k all</code>\u6765\u66f4\u65b0 initramfs</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#vfio","title":"\u914d\u7f6evfio","text":"<p>\u67e5\u627e\u9700\u8981\u76f4\u901a\u7684\u663e\u5361\u3001\u58f0\u5361id\uff1a</p> <pre><code>lspci -D -nn | grep VGA\nlspci -D -nn | grep Audio\n0000:01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD106M [GeForce RTX 4070 Max-Q / Mobile] [10de:2860] (rev a1)\n0000:c7:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Phoenix3 [1002:1900] (rev ba)\n0000:01:00.1 Audio device [0403]: NVIDIA Corporation AD106M High Definition Audio Controller [10de:22bd] (rev a1)\n0000:c7:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Radeon High Definition Audio Controller [Rembrandt/Strix] [1002:1640]\n0000:c7:00.6 Audio device [0403]: Advanced Micro Devices, Inc. [AMD] Family 17h/19h/1ah HD Audio Controller \n</code></pre> <p>\u8bb0\u4e0b\u9700\u8981\u76f4\u901a\u7684\u8bbe\u5907\u7684 vendor id \u548c device id,\u5bf9\u4e8e NVIDIA,\u56e0\u6b64\u5c31\u662f\u663e\u5361 <code>10de:2860</code> \u548c <code>10de:22bd</code></p> <p>\u7f16\u8f91 <code>/etc/modprobe.d/vfio.conf</code> \u6765\u8bbe\u7f6e vfio \u53c2\u6570,ids \u540e\u9762\u6dfb\u52a0\u7684\u5c31\u662f\u9700\u8981\u76f4\u901a\u7684\u8bbe\u5907 id,\u540e\u9762 softdep \u662f\u8ba9\u5185\u6838\u5728\u52a0\u8f7d\u8fd9\u4e9b\u6a21\u5757\u4e4b\u524d\u4f18\u5148\u52a0\u8f7d vfio,\u907f\u514d\u88ab\u9a71\u52a8\u6a21\u5757\u62a2\u5148,\u8fd9\u91cc\u53ea\u6709 NVIDIA \u7684\u9a71\u52a8\u6a21\u5757,\u5982\u679c\u4f7f\u7528 intel \u6216\u8005 amd \u7684\u663e\u5361\u9700\u8981\u6539\u4e3a\u5bf9\u5e94\u7684\u6a21\u5757</p> <pre><code>options vfio-pci ids=10de:0fc6,10de:0e1b\nsoftdep nouveau pre: vfio-pci\nsoftdep nvidia pre: vfio-pci\nsoftdep nvidiafb pre: vfio-pci\nsoftdep nvidia_drm pre: vfio-pci\nsoftdep drm pre: vfio-pci\n</code></pre> <p>\u91cd\u65b0\u542f\u52a8\u5c31\u53ef\u4ee5\u5f00\u59cb\u914d\u7f6e\u663e\u5361\u76f4\u901a\u4e86</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#_1","title":"\u914d\u7f6e\u663e\u5361\u76f4\u901a","text":"<p>\u663e\u5361\uff1aNVIDIA Corporation AD106M [GeForce RTX 4070 Max-Q / Mobile]</p> <p>\u52fe\u9009 ROM-Bar, PCI-Express, Primary GPU  </p> <p>\u58f0\u5361\uff1a NVIDIA Corporation AD106M High Definition Audio Controller</p> <p>\ud83d\udca1\u6211\u7684\u60c5\u51b5\u5e76\u4e0d\u9700\u8981\u914d\u7f6evbios\u5373\u53ef\u5de5\u4f5c\uff0c\u6709\u9700\u8981\u53ef\u4ee5\u53c2\u8003\u6765\u63d0\u53d6\u5e76\u914d\u7f6evbios: 1</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9Awindows/#optional-msrs","title":"Optional \u5ffd\u7565MSRS\u9519\u8bef","text":"<pre><code>echo \"options kvm ignore_msrs=1 report_ignored_msrs=0\" &gt; /etc/modprobe.d/kvm.conf\n</code></pre> <ul> <li><code>ignore_msrs=1</code>\u00a0- \u5ffd\u7565\u865a\u62df\u673a\u5bf9\u4e0d\u652f\u6301\u7684 MSR (Model Specific Register) \u7684\u8bbf\u95ee</li> <li><code>report_ignored_msrs=0</code>\u00a0- \u4e0d\u5728\u5185\u6838\u65e5\u5fd7\u4e2d\u62a5\u544a\u88ab\u5ffd\u7565\u7684 MSR \u8bbf\u95ee</li> </ul> <p>MSR \u662f\u4ec0\u4e48\uff1a</p> <p>MSR (Model Specific Register) \u662f CPU \u7279\u5b9a\u7684\u5bc4\u5b58\u5668\uff0c\u4e0d\u540c\u7684 CPU \u578b\u53f7\u6709\u4e0d\u540c\u7684 MSR\u3002\u865a\u62df\u673a\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u8bbf\u95ee\u5bbf\u4e3b\u673a CPU \u4e0d\u652f\u6301\u7684 MSR\u3002</p> <p>\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u4e9b\u53c2\u6570\uff1a</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u865a\u62df\u673a\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684 MSR \u65f6\uff1a</p> <ul> <li>KVM \u4f1a\u62d2\u7edd\u8bbf\u95ee\u5e76\u53ef\u80fd\u5bfc\u81f4\u865a\u62df\u673a\u5d29\u6e83</li> <li>\u5185\u6838\u65e5\u5fd7\u4f1a\u88ab\u5927\u91cf\u9519\u8bef\u4fe1\u606f\u5237\u5c4f</li> </ul> <p>\u4f7f\u7528\u573a\u666f\uff1a</p> <p>\u5e38\u89c1\u4e8e\uff1a</p> <ol> <li>\u8fd0\u884c Windows \u865a\u62df\u673a\uff08Windows \u7ecf\u5e38\u8bbf\u95ee\u5404\u79cd MSR\uff09</li> <li>CPU \u76f4\u901a\u6216\u5d4c\u5957\u865a\u62df\u5316</li> <li>\u865a\u62df\u673a CPU \u578b\u53f7\u4e0e\u5bbf\u4e3b\u673a\u4e0d\u5b8c\u5168\u5339\u914d</li> </ol> <p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>[2]: \u5728 Proxmox \u4e0a\u9032\u884c PCI-E \u76f4\u901a [3]: Proxmox VE 8.4 \u663e\u5361\u76f4\u901a\u5b8c\u6574\u6307\u5357\uff1aNVIDIA 2080 Ti \u5b9e\u6218\u80cc\u666f\uff1a PCIe Passthroug - \u6398\u91d1</p>","tags":["FnOS","NAS","PVE"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/","title":"PVE \u72ec\u663e\u76f4\u901a\u529f\u8017\u4f18\u5316","text":"","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#windows-vs-windows","title":"\u53ca\u65f6\u5173\u95edWindows VS \u4fdd\u6301Windows\u5f85\u673a\uff1f","text":"<p>\u7b54\u6848\u662f\u4fdd\u6301Windows \u5f85\u673a\u3002</p> <p>\u5173\u95ed Windows \u865a\u62df\u673a\u5e76\u4e0d\u4f1a\u4f7f\u771f\u5b9e\u786c\u4ef6\u65ad\u7535\uff0c\u56e0\u6b64\u663e\u5361\u4ecd\u4f1a\u4fdd\u6301\u901a\u7535\u8fd0\u884c\u72b6\u6001\u3002\u7531\u4e8e\u663e\u5361\u5df2\u7ecf\u76f4\u901a\u7ed9\u4e86 Windows\uff0cPVE host \u5df2\u7ecf\u5931\u53bb\u4e86\u5bf9\u663e\u5361\u7684\u63a7\u5236\u6743\u3002</p> <p>\u8fd9\u4f1a\u5bfc\u81f4\u663e\u5361\u7f3a\u4e4f\u6709\u6548\u7684\u8f6f\u4ef6\u63a7\u5236\uff0c\u53ef\u80fd\u4e00\u76f4\u5904\u4e8e\u9ad8\u8d1f\u8377\u8fd0\u8f6c\u72b6\u6001\uff0c\u53cd\u800c\u9020\u6210\u66f4\u9ad8\u7684\u529f\u8017\u548c\u66f4\u5927\u7684\u566a\u97f3\u3002</p> <p>\u4f46\u662f\u4f17\u6240\u5468\u77e5\uff0cWindows\u7684\u5f85\u673a\u529f\u8017\u4e0d\u5c3d\u5982\u4eba\u610f\uff0c\u6709\u6ca1\u6709\u4e00\u79cd\u53ef\u4ee5\u5173\u95edWindows\u4f46\u4e0d\u8ba9\u6838\u663e\u5931\u63a7\u7684\u65b9\u5f0f\u5462\uff1f</p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_1","title":"\u5907\u7528\u7cfb\u7edf","text":"<p>\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5c3d\u53ef\u80fd\u7cbe\u7b80\u548c\u4f4e\u529f\u8017\u7684\u7cfb\u7edf\uff0c\u5f53Windows\u5173\u95ed\u4e4b\u540e\u6765\u4ee5\u6700\u4f4e\u6210\u672c\u63a5\u7ba1\u663e\u5361\u3002</p> <p>\u6211\u9009\u62e9\u521b\u5efa\u4e00\u4e2aArchlinux VM\uff0c\u53ef\u4ee5\u6839\u636e\u6211\u7684\u9700\u6c42\u9ad8\u5ea6\u81ea\u5b9a\u4e49\uff0c\u6bd4\u5982\u4e0d\u7528compositor\uff0cdisplay manager\u548cDE/WM\u53ea\u9700\u8981tty\u3002\u5982\u679c\u89c9\u5f97\u9ebb\u70e6\u53ef\u4ee5\u4f7f\u7528Debian\u7cfb\u7edf\u3002</p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#archlinux-vm","title":"\u521b\u5efaArchlinux VM","text":"<p>\u4f7f\u7528\u5982\u4e0b\u914d\u7f6e\u521b\u5efaArchlinux\u865a\u62df\u673a\uff0c\u7136\u540e\u8fdb\u884c\u5b89\u88c5\u3002</p> <p>\u26a0\ufe0f \u8bf7\u5b8c\u5168\u6309\u7167\u622a\u56fe\u8bbe\u7f6e\uff0c\u9664\u975e\u4f60\u77e5\u9053\u4f60\u5728\u505a\u4ec0\u4e48\u3002</p> <p> \u5177\u4f53\u5b89\u88c5\u8fc7\u7a0b\u53c2\u8003\uff1a https://wiki.archlinux.org/title/Installation_guide, \u4e0b\u9762\u662f\u4e00\u4e9b\u8981\u70b9\u3002</p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#boot-loader","title":"Boot loader","text":"<p>\u6211\u91c7\u7528\u4e86systemd-boot\uff0c\u4e5f\u53ef\u9009grub\uff0c\u53c2\u8003\uff1a https://wiki.archlinux.org/title/Arch_boot_process#Boot_loader</p> <ol> <li>\u5b89\u88c5systemd-boot\u5230boot\u5206\u533a     <pre><code>bootctl install\n</code></pre></li> <li>\u521b\u5efaboot configuration: <code>/boot/loader/loader.conf</code> <pre><code>default  arch.conf\ntimeout  4\nconsole-mode max\neditor   no\n</code></pre></li> <li>\u521b\u5efaarch configuration: <code>/boot/loader/entries/arch.conf</code> <pre><code>title   Arch Linux\nlinux   /vmlinuz-linux\ninitrd  /initramfs-linux.img\noptions root=UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx rw consoleblank=60\n</code></pre>     \u6ce8\u610f <code>consoleblank=60</code> , \u7528\u6765\u81ea\u52a8\u572860s idle\u540e\u5173\u95ed\u89c6\u9891\u8f93\u51fa\uff0c\u51cf\u5c11\u663e\u793a\u5f00\u9500\u3002     &gt; UUID \u53ef\u4ee5\u901a\u8fc7 <code>sudo blkid</code> \u83b7\u53d6\uff0c\u4e5f\u53ef\u4ee5\u7528     &gt;   a. <code>root=PARTUUID=xxxx</code>      &gt;   b. <code>root=/dev/sda2</code>      &gt;   c. <code>root=LABEL=root\\x20partition</code></li> <li>(\u53ef\u9009) \u521b\u5efaarch-fallback configuration: <code>/boot/loader/entries/arch-fallback.conf</code> <pre><code>title Arch Linux (fallback initramfs)\nlinux /vmlinuz-linux\ninitrd /initramfs-linux-fallback.img\noptions root=UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx rw\n</code></pre></li> </ol>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_2","title":"\u7f51\u7edc\u914d\u7f6e","text":"<p>\u8fd9\u91cc\u4f9d\u65e7\u4f7f\u7528systemd\uff0c\u4e0d\u9700\u8981\u5b89\u88c5\u989d\u5916\u7684\u8f6f\u4ef6\u3002 \u53c2\u8003https://wiki.archlinux.org/title/Systemd-networkd</p> <p>\ud83d\udca1\u5047\u8bbe\u5f53\u524d\u7f51\u7edc\u63a5\u53e3\u662fens18. \u53ef\u4f7f\u7528 <code>ip link</code>\uff0c\u6765\u67e5\u770b\u5b9e\u9645\u63a5\u53e3\u540d\u79f0</p> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 <code>/etc/systemd/network/20-wired.network</code> \u53ef\u4ee5\u9009\u62e9\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f:</p> <ol> <li> <p>DHCP - \u81ea\u52a8\u83b7\u5f97IP \u5730\u5740</p> <pre><code>[Match]\nName=ens18\n\n[Link]\nRequiredForOnline=routable\n\n[Network]\nDHCP=yes\n</code></pre> </li> <li> <p>Static IP - \u4f7f\u7528\u9759\u6001IP\u5730\u5740</p> <pre><code>[Match]\nName=ens18\n\n[Network]\nAddress=10.1.10.9/24\nAddress=2001:db8:1234:5678::1/64\nGateway=10.1.10.1\nGateway=fe80::1\nDNS=10.1.10.1\nDNS=2001:db8:1122::3344:1\n</code></pre> </li> </ol> <p>\u542f\u52a8\u7f51\u7edc\u670d\u52a1</p> <pre><code># \u542f\u7528systemd DNS service\nsystemctl enable --now systemd-resolved\n# \u542f\u7528systemd netowrkd\nsystemctl enable --now systemd-networkd\n# \u67e5\u770b\u63a5\u53e3\u72b6\u6001\nnetworkctl\n</code></pre>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#ssh-server","title":"\u5f00\u542fssh server","text":"<p>https://wiki.archlinux.org/title/OpenSSH</p> <pre><code>sudo pacman -S openssh\nsudo systemctl enable --now sshd\n</code></pre>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_3","title":"\u53ef\u9009\u5b89\u88c5","text":"<ol> <li><code>yay</code>: https://github.com/Jguer/yay \u5efa\u8bae\u4f7f\u7528archlinuxcn\u6e90\u5b89\u88c5:  https://mirrors.ustc.edu.cn/help/archlinuxcn.html</li> <li><code>qemu-guest-agent</code>: qemu\u865a\u62df\u673a\u589e\u5f3a\u670d\u52a1\uff0c\u9700\u8981\u5728VM Options \u4e2d\u5f00\u542f Qemu Agent\u914d\u5408\u4f7f\u7528</li> </ol>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_4","title":"\u7535\u6e90\u7ba1\u7406","text":"<p>\u4f7f\u7528 <code>tlp</code> \u6765\u7ba1\u7406\u7535\u6e90\uff0c\u53ef\u9009 <code>powertop --auto-tune</code></p> <pre><code># \u5b89\u88c5tlp\nsudo pacman -S tlp\n# \u542f\u52a8tlp service\nsudo systemctl enable --now tlp\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ctlp\u4f1a\u5728AC/\u9ed8\u8ba4\u6a21\u5f0f\u4e0b\u542f\u7528Performance profile. \u9700\u8981\u8fdb\u884c\u4fee\u6539: <code>/etc/tlp.conf</code> </p> <pre><code>TLP_DEFAULT_MODE=SAV     #\u9ed8\u8ba4\u7701\u7535\u6a21\u5f0f\nTLP_PERSISTENT_DEFAULT=1 #\u5f53\u524d\u6a21\u5f0f\u56fa\u5b9a\u4e3a\u9ed8\u8ba4\n</code></pre> <p>\u91cd\u542f\u670d\u52a1\uff0c\u5e76\u68c0\u67e5</p> <pre><code>sudo systemctl restart tlp\nsudo tlp-stat -s\n--- TLP 1.9.0 --------------------------------------------\n\n+++ System Info\nSystem         = QEMU pc-q35-10.1 Standard PC (Q35 + ICH9, 2009)\nBIOS           = 4.2025.05-2 Proxmox distribution of EDK II\nOS Release     = Arch Linux\nKernel         = 6.17.9-arch1-1 #1 SMP PREEMPT_DYNAMIC Mon, 24 Nov 2025 15:21:09 +0000 x86_64\n/proc/cmdline  = initrd=\\initramfs-linux.img root=/dev/sda3 rw consoleblank=60\nInit system    = systemd 258\nBoot mode      = UEFI\nSuspend mode   = [s2idle]\n\n+++ TLP Status\ntlp            = enabled, last run: 15:24:37, 39 sec(s) ago\ntlp-rdw            = not installed\ntlp-pd         = not installed\nPower profile  = power-saver/SAV\nPower source   = unknown\n</code></pre> <p>\u26a0\ufe0f  \u5728PVE VM\u4e2d\u9700\u8981\u907f\u514d\u4f7f\u7528<code>systemctl suspend</code> \uff0c\u56e0\u4e3a\u865a\u62df\u673a\u65e0\u6cd5\u63a7\u5236\u786c\u4ef6\u7684\u7535\u6e90 \u5373\u4f7f\u662f <code>s2idle</code>  mode\u4e5f\u4f1a\u9020\u6210GPU  crash <code>s2idle</code>\u00a0(Suspend-to-Idle) is designed to put\u00a0all\u00a0devices into a low-power state to save energy. The kernel iterates through every device driver (network, disk, USB, GPU) and tells them to execute their \"suspend\" routines. For the NVIDIA driver, this means stopping rendering, saving VRAM state, and powering down the card's engines. but it might not be supported. </p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_5","title":"\u5b89\u88c5\u72ec\u663e\u9a71\u52a8","text":"<p>\u4e00\u822c\u60c5\u51b5Nvidia \u72ec\u663e\u53ea\u9700\u8981\u5b89\u88c5\u5b98\u65b9\u9a71\u52a8\u5373\u53ef\uff0c \u66f4\u591a\u4f8b\u5916\u53c2\u8003\uff1a https://wiki.archlinux.org/title/NVIDIA</p> <pre><code>sudo pacman -S nvidia\n</code></pre>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_6","title":"\u914d\u7f6e\u663e\u5361\u76f4\u901a","text":"<p>\u8fd9\u4e00\u6b65\u8ddf\u914d\u7f6e\u663e\u5361\u76f4\u901a \u4e00\u81f4\uff0c \u4f46\u7531\u4e8e\u540c\u65f6\u914d\u7f6e\u7684\u663e\u5361\u76f4\u901a\uff0c\u6240\u4ee5Windows\u548cArchlinux\u4e0d\u80fd\u540c\u65f6\u542f\u52a8</p> <p>\u914d\u7f6e\u597d\u540e\uff0c\u5173\u6389Windows\u518d\u542f\u52a8Archlinux\uff0c\u8fd9\u65f6PVE Console\u5c06\u6ca1\u6709\u753b\u9762\uff0c\u89c6\u9891\u53ea\u4f1a\u4ece\u663e\u5361\u7684HDMI/DP\u63a5\u53e3\u8f93\u51fa\u3002\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\uff0c\u4f7f\u7528ssh\u767b\u5f55\u5373\u53ef\u67e5\u770b\u5f53\u524dNvidia GPU \u6570\u636e</p> <pre><code>[kevin@Archlinux ~]$ nvidia-smi\nWed Dec 10 15:33:20 2025       \n+-----------------------------------------------------------------------------------------+\n| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |\n+-----------------------------------------+------------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n|                                         |                        |               MIG M. |\n|=========================================+========================+======================|\n|   0  NVIDIA GeForce RTX 4070 ...    Off |   00000000:01:00.0 Off |                  N/A |\n| N/A   36C    P8              5W /   80W |      34MiB /   8188MiB |      0%      Default |\n|                                         |                        |                  N/A |\n+-----------------------------------------+------------------------+----------------------+\n\n+-----------------------------------------------------------------------------------------+\n| Processes:                                                                              |\n|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |\n|        ID   ID                                                               Usage      |\n|=========================================================================================|\n|  No running processes found                                                             |\n+---------------------\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5f53\u524dGPU\u529f\u8017\u6210\u529f\u964d\u5230P8\u5e76\u4e14\u53ea\u67095W\u5f85\u673a\u529f\u8017\uff0c\u8bf4\u660e\u914d\u7f6e\u6210\u529f\uff0c\u270c\ufe0f</p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#hook","title":"\u914d\u7f6e\u81ea\u52a8\u63a5\u7ba1hook","text":"<p>\u53ef\u4ee5\u4f7f\u7528snippet\u6765\u5e2e\u6211\u4eec\u81ea\u52a8\u5728Windows\u542f\u52a8\u7684\u65f6\u5019\u5173\u95edArchlinux\uff0c\u5173\u673a\u4e4b\u540e\u542f\u52a8Archlinux.</p>  \ud83d\udca1  \u5047\u8bbeWindows\u7684vmid\u662f101\uff0c Archlinux\u7684vmid\u662f104\u3002\u8bf7\u6839\u636e\u81ea\u5df1\u60c5\u51b5\u4fee\u6539   <pre><code>cd /var/lib/vz/snippets\ntouch nvidiavm.sh\nchmod +x nvidiavm.sh\ncat &gt; nvidiavm.sh &lt;&lt; \"EOF\"\n#!/bin/bash\nVMID=$1\nPHASE=$2\nDUMMY_VMID=104\n\nif [ \"$VMID\" = \"101\" ]; then\n  if [ \"$PHASE\" = \"pre-start\" ]; then\n    echo \"Win10 VM pre-start: Stopping Nvidia Dummy VM\"\n    qm stop $DUMMY_VMID\n\n  elif [ \"$PHASE\" = \"post-stop\" ]; then\n    echo \"Win10 VM post-stop: Starting Nvidia Dummy VM\"\n    qm start $DUMMY_VMID\n  fi\nfi\nEOF\n</code></pre> <p>\u628a\u5b83\u6dfb\u52a0\u5230Windows VM\u4e2d\uff1a</p> <pre><code>     qm set 101 --hookscript local:snippets/nvidiavm.sh\n</code></pre> <p>\u53ef\u4ee5\u5728\u65e5\u5fd7\u4e2d\u67e5\u770b\u811a\u672c\u8fd0\u884c\u60c5\u51b5</p> <pre><code>journalctl -b | grep \"Nvidia Dummy VM\"\nDec 09 14:11:04 pve qmeventd[82872]: Win10 VM post-stop: Starting Nvidia Dummy VM\nDec 09 19:29:09 pve qmeventd[192077]: Win10 VM post-stop: Starting Nvidia Dummy VM\n</code></pre>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E7%8B%AC%E6%98%BE%E7%9B%B4%E9%80%9A%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96/#_7","title":"\u53c2\u8003\u8d44\u6599","text":"<p>https://wiki.archlinux.org/title/TLP</p> <p>https://forum.proxmox.com/threads/high-power-usage-for-passthrough-gpu-when-vm-is-stopped.131346/</p>","tags":["NAS","FnOS"]},{"location":"NAS/PVE%20%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%A3%9E%E7%89%9BOS/","title":"PVE \u96c6\u6210\u663e\u5361\u76f4\u901a\u98de\u725bOS","text":"","tags":["NAS","PVE","FnOS"]},{"location":"NAS/PVE%20%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%A3%9E%E7%89%9BOS/#grub","title":"\u66f4\u65b0Grub","text":"<p>\u7f16\u8f91 <code>/etc/default/grub</code></p> <pre><code>GRUB_CMDLINE_LINUX_DEFAULT=\"quiet iommu=pt initcall_blacklist=sysfb_init pcie_acs_override=downstream,multifunction\"\n</code></pre> <p>\ud83d\udca1 pve\u5185\u6838\u7ecf\u5e38\u66f4\u65b0\uff0camd_iommu=on\u6709\u7684\u5185\u6838\u5df2\u7ecf\u5185\u7f6e\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u4e0a\u9762\u52a0amd_iommu=on\u3002\u5982\u679c\u9047\u5230\u66f4\u65b0pve\u5185\u6838\u540e\uff0c\u63d0\u793aiommu\u6ca1\u6709\u5f00\u542f\uff0c\u8bf7\u624b\u52a8\u5728\u4ee5\u4e0a\u6b64\u5904\u6dfb\u52a0amd_iommu=on\uff0c\u5e76update-grub\u91cd\u542f\u540e\u5373\u53ef\u89e3\u51b3\u3002</p> <ol> <li><code>iommu=pt</code> : \u4ec5\u5bf9\u76f4\u901a\u8bbe\u5907\u542f\u7528IOMMU\uff0c\u51cf\u5c11\u6027\u80fd\u5f00\u9500</li> <li><code>initcall_blacklist=sysfb_init</code> :\u542f\u52a8\u65f6\u8fd0\u884c\u9ed1\u540d\u5355\u5185\u6dfb\u52a0\u9879\uff0c\u5728Intel\u7684\u673a\u578b\u4e2d\uff0c\u6b64\u9879\u975e\u5fc5\u8981\u6dfb\u52a0\uff0c\u4f46\u662f\u5728amd\u673a\u578b\u4e2d\u5efa\u8bae\u6dfb\u52a0\uff0c\u5426\u5219\u4f1a\u5f71\u54cd\u6838\u663e\u76f4\u901a\u540e\u7684\u6027\u80fd\uff0c\u6bd4\u59824K60Hz\u964d\u4f4e\u523030Hz\u3002 \u9632\u6b62\u5bbf\u4e3b\u673a\u5360\u7528\u663e\u5361\u5e27\u7f13\u51b2\u533a</li> <li><code>pcie_acs_override=downstream,multifunction</code> \u89e3\u51b3\u67d0\u4e9bPCIe\u8bbe\u5907\u7684ACS\u9650\u5236\u95ee\u9898\uff0c\u907f\u514d\u6b7b\u673a</li> </ol> <p>\u7f16\u8f91 <code>/etc/modprobe.d/pve-blacklist.conf</code></p> <pre><code>blacklist nvidiafb\nblacklist amdgpu\noptions vfio_iommu_type1 allow_unsafe_interrupts=1\n</code></pre> <p>\u89e3\u91ca\uff1a\u5c4f\u853damd\u663e\u5361\u9a71\u52a8\uff0c <code>options vfio_iommu_type1</code> <code>allow_unsafe_interrupts=1</code> \u5141\u8bb8\u4e0d\u5b89\u5168\u7684\u8bbe\u5907\u4e2d\u65ad\uff0c\u5728\u90e8\u5206\u673a\u578b\u4e0a\u4e0d\u52a0\u6b64\u9879\u4f1a\u5bfc\u81f4\u865a\u62df\u673a\u542f\u52a8\u52a0\u8f7d\u8f6c\u5708\u65f6\u76f4\u63a5\u5bbf\u4e3bPVE\u5361\u6b7b\u3002</p> <p>\u6ce8\u610f\uff1a\u5728\u8bbe\u5907\u9ed1\u540d\u5355\u4e2d\u6dfb\u52a0amdgpu\uff0c\u5e76grub\u91cc\u5f00\u542f\u5f15\u5bfc\u81ea\u52a8\u52a0\u8f7d\u540e\uff0cpve\u542f\u52a8\u65f6\u4f1a\u5361\u5728\u4ee5\u4e0b\u754c\u9762\u3002\u662f\u6b63\u5e38\u7684\uff01\u7b49\u5f85\u4e00\u4f1a\u53ea\u8981PVE\u53ef\u4ee5\u901a\u8fc7\u7f51\u9875\u8bbf\u95ee\u5230WebUI\u7ba1\u7406\u9875\u9762\u5c31\u662f\u6b63\u5e38\u6ca1\u95ee\u9898\u7684\u3002\u56e0\u4e3aPVE\u5f00\u673a\u65f6\u4f1a\u6309\u7167\u8bbe\u5907\u9ed1\u540d\u5355\u8bbe\u7f6e\u7684\uff0c\u91ca\u653e\u5bf9\u6838\u663e\u7684\u63a7\u5236\u6743\u3002\u8fd9\u6837\u624d\u80fd\u5728\u6838\u663e\u76f4\u901a\u7ed9\u865a\u62dfWin\u7684\u65f6\u5019\u907f\u514d\u51b2\u7a81\u800c\u5bfc\u81f4\u7684\u65e0\u6cd5\u52a0\u8f7d\u9a71\u52a8\uff0c\u9519\u8bef\u4ee3\u780143 </p> <p>\u66f4\u65b0grub\u548cinitramfs\u5e76\u91cd\u542f</p> <pre><code>update-grub\nupdate-initramfs -u -k\nreboot\n</code></pre>","tags":["NAS","PVE","FnOS"]},{"location":"NAS/PVE%20%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%A3%9E%E7%89%9BOS/#vm","title":"\u521b\u5efaVM \u5b89\u88c5\u98de\u725b","text":"<p>\u6211\u4eec\u5148\u7528\u865a\u62df\u663e\u5361\u628a\u98de\u725b\u88c5\u597d\uff1a</p> <ul> <li>VM\u914d\u7f6e<ul> <li>\u663e\u5361\uff1aDefault</li> <li>\u673a\u578b\uff1aq35</li> <li>BIOS\uff1aOVMF</li> <li>EFI\u5206\u533a\uff1aUEFI\uff08OVMF\uff09\u9700\u8981</li> <li>TPM\u8bbe\u5907\uff1aNo</li> <li>\u78c1\u76d8\uff1aSCSI \u5927\u5c0f100G\uff08\u6309\u9700\u8bbe\u7f6e\uff0c\u6216\u786c\u76d8\u76f4\u901a\uff09</li> <li>CPU\uff1ahost \u6838\u5fc3\u6570\u91cf8\uff08\u6309\u9700\u8bbe\u7f6e\uff09</li> <li>\u5185\u5b58\uff1a4G\u53ca\u4ee5\u4e0a\uff08\u6838\u663e\u76f4\u901a\u5efa\u8bae\uff09</li> <li>\u7f51\u7edc\uff1avirtIO\uff08\u534a\u865a\u62df\u5316\u6216\u7f51\u5361\u76f4\u901a\uff09\u7f51\u5361</li> </ul> </li> </ul>","tags":["NAS","PVE","FnOS"]},{"location":"NAS/PVE%20%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%A3%9E%E7%89%9BOS/#_1","title":"\u663e\u5361\u76f4\u901a","text":"<p>\u5f53\u7cfb\u7edf\u5b89\u88c5\u6210\u529f\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u98de\u725b\u4e4b\u540e\uff0c\u8fdb\u884c\u76f4\u901a\uff1a <ol> <li>\u663e\u5361\u6539\u6210 none (\u8fd9\u4e00\u6b65\u4e4b\u540e\uff0c\u5c31\u65e0\u6cd5\u5728pve\u7684console\u4e2d\u770b\u5230\u865a\u62df\u673a\u753b\u9762\u4e86\uff09</li> <li>\u6dfb\u52a0PCI\u8bbe\u5907\uff1a<ul> <li>\u6dfb\u52a0\u663e\u5361\uff08pciid\u4e0d\u56fa\u5b9a\uff09pcie\u8bbe\u5907\u91cc\u9762\u52fe\u9009\uff1a\u4e3bgpu\uff0crom-bar\uff0cpcie-express\u8fd9\u4e09\u4e2a\u9009\u9879\uff0c\u6240\u6709\u529f\u80fd\uff1a\u4e0d\u52fe\u9009</li> <li>\u6dfb\u52a0\u58f0\u5361\uff08pciid\u4e0d\u56fa\u5b9a\uff09</li> </ul> </li> </ol> <p>\u53ef\u4ee5\u901a\u8fc7\u4e0b\u5217\u547d\u4ee4\u6765\u786e\u5b9a\u663e\u5361\u548c\u58f0\u5361\u8bbe\u5907\uff1a</p> <pre><code>lspci -D -nn | grep VGA\nlspci -D -nn | grep Audio\n....\nAdvanced Micro Devices, Inc. [AMD/ATI] Phoenix3\nAdvanced Micro Devices, Inc. [AMD/ATI] Radeon High Definition Audio Controller [Rembrandt/Strix]\n</code></pre> <p>\ud83d\udca1\u6ce8\u610f\uff1a\u663e\u5361\u7684PCI\u7ec4\u90fd\u4f1a\u5bf9\u5e94\u7ed1\u5b9a\u7740\u4e00\u4e2a\u58f0\u5361\uff0c\u9700\u8981\u4e24\u8005\u540c\u65f6\u76f4\u901a\u624d\u80fd\u6210\u529f\u3002</p>","tags":["NAS","PVE","FnOS"]},{"location":"NAS/PVE%20%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%A3%9E%E7%89%9BOS/#_2","title":"\u53c2\u8003\u8d44\u6599","text":"<ol> <li>https://diyforfun.cn/1552.html</li> </ol>","tags":["NAS","PVE","FnOS"]},{"location":"Topic%201/Note%201/","title":"Note 1","text":"<p>Example: link to Mermaid Diagrams under <code>Features</code></p>"},{"location":"Topic%201/Note%202/","title":"Note 2","text":""},{"location":"blog/","title":"Blog","text":""}]}